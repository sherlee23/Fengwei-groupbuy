<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>é”‹å‘³æ´¾ç¾é£Ÿå›¢è´­</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
  <style>
    body {
      font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
      max-width: 640px;
      margin: 0 auto;
      padding: 0 16px 100px;
      background: #fefefe;
      color: #333;
    }
    h1, h2, h3 {
      color: #d33;
    }
    .header {
      text-align: center;
      padding: 20px 0;
      background: linear-gradient(45deg, #ff6b81, #ff4757);
      color: white;
      border-radius: 0 0 12px 12px;
    }
    .header h1 {
      margin: 0;
      font-size: 26px;
    }
    .form-group {
      margin-bottom: 18px;
    }
    .form-group label {
      font-weight: bold;
      display: block;
      margin-bottom: 6px;
    }
    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 10px;
      border: 2px solid #ccc;
      border-radius: 6px;
      font-size: 16px;
    }
    .form-group textarea {
      resize: vertical;
      min-height: 48px;
      max-height: 150px;
    }
    .product {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 14px;
      background: #fff;
    }
    .product-image-container {
      width: 100%;
      height: 180px;
      text-align: center;
      background: #f8f8f8;
      border-radius: 6px;
      overflow: hidden;
      margin-bottom: 8px;
    }
    .product-image {
      height: 100%;
      width: auto;
      object-fit: contain;
    }
    .product-name {
      font-weight: bold;
      margin-bottom: 6px;
    }
    .product-price {
      color: #e74c3c;
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 6px;
    }
    .quantity-control {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .quantity-btn {
      width: 32px;
      height: 32px;
      border: none;
      background: #ff6b81;
      color: white;
      border-radius: 50%;
      font-size: 18px;
      cursor: pointer;
    }
    .quantity-input {
      width: 50px;
      text-align: center;
      font-weight: bold;
      font-size: 16px;
    }
    .total {
      font-size: 20px;
      font-weight: bold;
      margin-top: 20px;
      text-align: right;
      border-top: 1px solid #ccc;
      padding-top: 10px;
    }
    .submit-btn {
      width: 100%;
      padding: 14px;
      background: linear-gradient(45deg, #ff6b81, #ff4757);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 18px;
      cursor: pointer;
      margin-top: 20px;
    }
    .admin-export {
      display: none;
      margin-top: 20px;
    }
    .bank-info {
      background: #fff8f0;
      padding: 10px;
      border-radius: 8px;
      margin-top: 20px;
      font-size: 15px;
      line-height: 1.6;
    }
    .bank-info img {
      width: 48%;
      border-radius: 8px;
    }
    .category-title {
      font-size: 20px;
      font-weight: bold;
      border-left: 4px solid #ff4757;
      padding-left: 10px;
      margin: 25px 0 10px;
    }
    .disclaimer-box {
      background: #fff0f0;
      border-left: 4px solid #ff4757;
      padding: 14px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    .disclaimer-box p {
      margin: 6px 0;
      font-size: 14px;
    }
    .disclaimer-checkbox {
      margin-top: 12px;
      display: flex;
      align-items: center;
    }
    .disclaimer-checkbox input {
      margin-right: 8px;
    }
    .file-upload input {
      border: 2px dashed #ccc;
      padding: 12px;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>ğŸ¢ é”‹å‘³æ´¾ç¾é£Ÿå›¢è´­</h1>
  </div>

  <form id="orderForm">
    <div class="disclaimer-box">
      <p>âš ï¸ æ­¤ä¸ºé¢„è´­å•†å“ï¼Œé¢„è®¡å‘è´§æ—¶é—´ä¸ºä¸‹å•å30-60å¤©</p>
      <p>âš ï¸ å½“å‰ä»·æ ¼ä¸å«è¿è´¹ï¼Œè¿è´¹å°†å¦è¡Œé€šçŸ¥</p>
      <div class="disclaimer-checkbox">
        <input type="checkbox" id="agreeCheckbox" required />
        <label for="agreeCheckbox">æˆ‘å·²é˜…è¯»å¹¶åŒæ„ä»¥ä¸Šå£°æ˜</label>
      </div>
    </div>

    <div class="form-group">
      <label for="name">ğŸ‘¤ å§“å *</label>
      <input type="text" id="name" name="name" required />
    </div>

    <div class="form-group">
      <label for="phone">ğŸ“ ç”µè¯ *</label>
      <input type="tel" id="phone" name="phone" required />
    </div>

    <div class="form-group">
      <label for="delivery">ğŸšš å–è´§æ–¹å¼ *</label>
      <select id="delivery" name="delivery" required>
        <option value="">è¯·é€‰æ‹©...</option>
        <option value="è‡ªå–">è‡ªå– Self Pickup</option>
        <option value="Lalamove">Lalamove</option>
      </select>
    </div>

<!-- ğŸ›’ å•†å“æ¸…å•å¼€å§‹ -->

<h3 class="category-title"><span class="emoji">ğŸŒ­</span>çƒ¤è‚ ç³»åˆ—</h3>

<div class="product">
  <div class="product-image-container"><img src="IMG_3859.jpeg" class="product-image" alt="åŸå‘³çƒ¤è‚ "></div>
  <div class="product-name">åŸå‘³çƒ¤è‚ </div>
  <div class="product-price">RM28</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="åŸå‘³çƒ¤è‚ ">-</button>
    <input type="number" class="quantity-input" id="åŸå‘³çƒ¤è‚ " value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="åŸå‘³çƒ¤è‚ ">+</button>
  </div>
</div>

<div class="product">
  <div class="product-image-container"><img src="IMG_3864.jpeg" class="product-image" alt="çƒŸç†èœœæ±çƒ¤è‚ "></div>
  <div class="product-name">çƒŸç†èœœæ±çƒ¤è‚ </div>
  <div class="product-price">RM28</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="çƒŸç†èœœæ±çƒ¤è‚ ">-</button>
    <input type="number" class="quantity-input" id="çƒŸç†èœœæ±çƒ¤è‚ " value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="çƒŸç†èœœæ±çƒ¤è‚ ">+</button>
  </div>
</div>

<div class="product">
  <div class="product-image-container"><img src="IMG_3863.jpeg" class="product-image" alt="æ³•å¼é¦™è‰çƒ¤è‚ "></div>
  <div class="product-name">æ³•å¼é¦™è‰çƒ¤è‚ </div>
  <div class="product-price">RM28</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="æ³•å¼é¦™è‰çƒ¤è‚ ">-</button>
    <input type="number" class="quantity-input" id="æ³•å¼é¦™è‰çƒ¤è‚ " value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="æ³•å¼é¦™è‰çƒ¤è‚ ">+</button>
  </div>
</div>

<div class="product">
  <div class="product-image-container"><img src="IMG_3860.jpeg" class="product-image" alt="é»‘èƒ¡æ¤’çƒ¤è‚ "></div>
  <div class="product-name">é»‘èƒ¡æ¤’çƒ¤è‚ </div>
  <div class="product-price">RM28</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="é»‘èƒ¡æ¤’çƒ¤è‚ ">-</button>
    <input type="number" class="quantity-input" id="é»‘èƒ¡æ¤’çƒ¤è‚ " value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="é»‘èƒ¡æ¤’çƒ¤è‚ ">+</button>
  </div>
</div>

<div class="product">
  <div class="product-image-container"><img src="IMG_3862.jpeg" class="product-image" alt="å­œç„¶è„†éª¨çƒ¤è‚ "></div>
  <div class="product-name">å­œç„¶è„†éª¨çƒ¤è‚ </div>
  <div class="product-price">RM28</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="å­œç„¶è„†éª¨çƒ¤è‚ ">-</button>
    <input type="number" class="quantity-input" id="å­œç„¶è„†éª¨çƒ¤è‚ " value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="å­œç„¶è„†éª¨çƒ¤è‚ ">+</button>
  </div>
</div>

<div class="product">
  <div class="product-image-container"><img src="IMG_3861.jpeg" class="product-image" alt="èŠå£«ç‰ç±³çƒ¤è‚ "></div>
  <div class="product-name">èŠå£«ç‰ç±³çƒ¤è‚ </div>
  <div class="product-price">RM28</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="èŠå£«ç‰ç±³çƒ¤è‚ ">-</button>
    <input type="number" class="quantity-input" id="èŠå£«ç‰ç±³çƒ¤è‚ " value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="èŠå£«ç‰ç±³çƒ¤è‚ ">+</button>
  </div>
</div>

<!-- ğŸ¦ è™¾è‚ &è™¾é¥¼ç³»åˆ— -->
<h3 class="category-title"><span class="emoji">ğŸ¦</span>è™¾è‚ &è™¾é¥¼ç³»åˆ—</h3>

<div class="product">
  <div class="product-image-container"><img src="IMG_3853.jpeg" class="product-image" alt="åŸå‘³è™¾è‚ "></div>
  <div class="product-name">åŸå‘³è™¾è‚ </div>
  <div class="product-price">RM33</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="åŸå‘³è™¾è‚ ">-</button>
    <input type="number" class="quantity-input" id="åŸå‘³è™¾è‚ " value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="åŸå‘³è™¾è‚ ">+</button>
  </div>
</div>

<div class="product">
  <div class="product-image-container"><img src="IMG_3854.jpeg" class="product-image" alt="è¾£å‘³è™¾è‚ "></div>
  <div class="product-name">è¾£å‘³è™¾è‚ </div>
  <div class="product-price">RM33</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="è¾£å‘³è™¾è‚ ">-</button>
    <input type="number" class="quantity-input" id="è¾£å‘³è™¾è‚ " value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="è¾£å‘³è™¾è‚ ">+</button>
  </div>
</div>

<div class="product">
  <div class="product-image-container"><img src="IMG_3873.jpeg" class="product-image" alt="åŸå‘³è™¾é¥¼"></div>
  <div class="product-name">åŸå‘³è™¾é¥¼</div>
  <div class="product-price">RM28</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="åŸå‘³è™¾é¥¼">-</button>
    <input type="number" class="quantity-input" id="åŸå‘³è™¾é¥¼" value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="åŸå‘³è™¾é¥¼">+</button>
  </div>
</div>

<!-- ğŸ• æŠ«è¨ç³»åˆ— -->
<h3 class="category-title"><span class="emoji">ğŸ•</span>æŠ«è¨ç³»åˆ—</h3>

<div class="product">
  <div class="product-image-container"><img src="IMG_3841.jpeg" class="product-image" alt="ç›æ ¼ä¸½ç‰¹æŠ«è¨"></div>
  <div class="product-name">ç›æ ¼ä¸½ç‰¹æŠ«è¨</div>
  <div class="product-price">RM25</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="ç›æ ¼ä¸½ç‰¹æŠ«è¨">-</button>
    <input type="number" class="quantity-input" id="ç›æ ¼ä¸½ç‰¹æŠ«è¨" value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="ç›æ ¼ä¸½ç‰¹æŠ«è¨">+</button>
  </div>
</div>

<div class="product">
  <div class="product-image-container"><img src="IMG_3839.jpeg" class="product-image" alt="é»‘æ¤’ç‰›è‚‰æŠ«è¨"></div>
  <div class="product-name">é»‘æ¤’ç‰›è‚‰æŠ«è¨</div>
  <div class="product-price">RM25</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="é»‘æ¤’ç‰›è‚‰æŠ«è¨">-</button>
    <input type="number" class="quantity-input" id="é»‘æ¤’ç‰›è‚‰æŠ«è¨" value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="é»‘æ¤’ç‰›è‚‰æŠ«è¨">+</button>
  </div>
</div>

<div class="product">
  <div class="product-image-container"><img src="IMG_3840.jpeg" class="product-image" alt="å¥¥å°”è‰¯é¸¡è‚‰æŠ«è¨"></div>
  <div class="product-name">å¥¥å°”è‰¯é¸¡è‚‰æŠ«è¨</div>
  <div class="product-price">RM25</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="å¥¥å°”è‰¯é¸¡è‚‰æŠ«è¨">-</button>
    <input type="number" class="quantity-input" id="å¥¥å°”è‰¯é¸¡è‚‰æŠ«è¨" value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="å¥¥å°”è‰¯é¸¡è‚‰æŠ«è¨">+</button>
  </div>
</div>

<div class="product">
  <div class="product-image-container"><img src="IMG_3852.jpeg" class="product-image" alt="åŒæ–™æ¦´è²æŠ«è¨"></div>
  <div class="product-name">åŒæ–™æ¦´è²æŠ«è¨</div>
  <div class="product-price">RM40</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="åŒæ–™æ¦´è²æŠ«è¨">-</button>
    <input type="number" class="quantity-input" id="åŒæ–™æ¦´è²æŠ«è¨" value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="åŒæ–™æ¦´è²æŠ«è¨">+</button>
  </div>
</div>

<!-- ğŸ¥® é…¥é¥¼ç³»åˆ— -->
<h3 class="category-title"><span class="emoji">ğŸ¥®</span>é…¥é¥¼ç³»åˆ—</h3>

<div class="product">
  <div class="product-image-container"><img src="IMG_3837.jpeg" class="product-image" alt="é»‘çŒªè‚‰é…¥é¥¼"></div>
  <div class="product-name">é»‘çŒªè‚‰é…¥é¥¼</div>
  <div class="product-price">RM55</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="é»‘çŒªè‚‰é…¥é¥¼">-</button>
    <input type="number" class="quantity-input" id="é»‘çŒªè‚‰é…¥é¥¼" value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="é»‘çŒªè‚‰é…¥é¥¼">+</button>
  </div>
</div>

<div class="product">
  <div class="product-image-container"><img src="IMG_3838.jpeg" class="product-image" alt="å®‰æ ¼æ–¯ç‰›è‚‰é…¥é¥¼"></div>
  <div class="product-name">å®‰æ ¼æ–¯ç‰›è‚‰é…¥é¥¼</div>
  <div class="product-price">RM55</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="å®‰æ ¼æ–¯ç‰›è‚‰é…¥é¥¼">-</button>
    <input type="number" class="quantity-input" id="å®‰æ ¼æ–¯ç‰›è‚‰é…¥é¥¼" value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="å®‰æ ¼æ–¯ç‰›è‚‰é…¥é¥¼">+</button>
  </div>
</div>

<!-- ğŸ¥Ÿ å°ç¬¼æ±¤åŒ…ç³»åˆ— -->
<h3 class="category-title"><span class="emoji">ğŸ¥Ÿ</span>å°ç¬¼æ±¤åŒ…ç³»åˆ—</h3>

<div class="product">
  <div class="product-image-container"><img src="IMG_3874.jpeg" class="product-image" alt="é²œè‚‰å°ç¬¼æ±¤åŒ…"></div>
  <div class="product-name">é²œè‚‰å°ç¬¼æ±¤åŒ…</div>
  <div class="product-price">RM12</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="é²œè‚‰å°ç¬¼æ±¤åŒ…">-</button>
    <input type="number" class="quantity-input" id="é²œè‚‰å°ç¬¼æ±¤åŒ…" value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="é²œè‚‰å°ç¬¼æ±¤åŒ…">+</button>
  </div>
</div>

<div class="product">
  <div class="product-image-container"><img src="IMG_3875.jpeg" class="product-image" alt="èŒè‡å°ç¬¼æ±¤åŒ…"></div>
  <div class="product-name">èŒè‡å°ç¬¼æ±¤åŒ…</div>
  <div class="product-price">RM12</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="èŒè‡å°ç¬¼æ±¤åŒ…">-</button>
    <input type="number" class="quantity-input" id="èŒè‡å°ç¬¼æ±¤åŒ…" value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="èŒè‡å°ç¬¼æ±¤åŒ…">+</button>
  </div>
</div>

<div class="product">
  <div class="product-image-container"><img src="IMG_3876.jpeg" class="product-image" alt="é»‘æ¾éœ²å°ç¬¼æ±¤åŒ…"></div>
  <div class="product-name">é»‘æ¾éœ²å°ç¬¼æ±¤åŒ…</div>
  <div class="product-price">RM12</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="é»‘æ¾éœ²å°ç¬¼æ±¤åŒ…">-</button>
    <input type="number" class="quantity-input" id="é»‘æ¾éœ²å°ç¬¼æ±¤åŒ…" value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="é»‘æ¾éœ²å°ç¬¼æ±¤åŒ…">+</button>
  </div>
</div>

<!-- ğŸ— é¸¡æ’&é¸¡ç¿…ç³»åˆ— -->
<h3 class="category-title"><span class="emoji">ğŸ—</span>é¸¡æ’&é¸¡ç¿…ç³»åˆ—</h3>

<div class="product">
  <div class="product-image-container"><img src="IMG_3835.jpeg" class="product-image" alt="åŸå‘³é¸¡æ’"></div>
  <div class="product-name">åŸå‘³é¸¡æ’</div>
  <div class="product-price">RM20</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="åŸå‘³é¸¡æ’">-</button>
    <input type="number" class="quantity-input" id="åŸå‘³é¸¡æ’" value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="åŸå‘³é¸¡æ’">+</button>
  </div>
</div>

<div class="product">
  <div class="product-image-container"><img src="IMG_3836.jpeg" class="product-image" alt="å¥¥å°”è‰¯é¸¡æ’"></div>
  <div class="product-name">å¥¥å°”è‰¯é¸¡æ’</div>
  <div class="product-price">RM20</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="å¥¥å°”è‰¯é¸¡æ’">-</button>
    <input type="number" class="quantity-input" id="å¥¥å°”è‰¯é¸¡æ’" value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="å¥¥å°”è‰¯é¸¡æ’">+</button>
  </div>
</div>

<div class="product">
  <div class="product-image-container"><img src="IMG_3865.jpeg" class="product-image" alt="å¥¥å°”è‰¯é¸¡ç¿…"></div>
  <div class="product-name">å¥¥å°”è‰¯é¸¡ç¿…</div>
  <div class="product-price">RM25</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="å¥¥å°”è‰¯é¸¡ç¿…">-</button>
    <input type="number" class="quantity-input" id="å¥¥å°”è‰¯é¸¡ç¿…" value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="å¥¥å°”è‰¯é¸¡ç¿…">+</button>
  </div>
</div>

<div class="product">
  <div class="product-image-container"><img src="IMG_3866.jpeg" class="product-image" alt="é’èŠ±æ¤’é¸¡ç¿…"></div>
  <div class="product-name">é’èŠ±æ¤’é¸¡ç¿…</div>
  <div class="product-price">RM25</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="é’èŠ±æ¤’é¸¡ç¿…">-</button>
    <input type="number" class="quantity-input" id="é’èŠ±æ¤’é¸¡ç¿…" value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="é’èŠ±æ¤’é¸¡ç¿…">+</button>
  </div>
</div>

<!-- ğŸ¥Ÿ çº¸çš®çƒ§å–ç³»åˆ— -->
<h3 class="category-title"><span class="emoji">ğŸ¥Ÿ</span>çº¸çš®çƒ§å–ç³»åˆ—</h3>

<div class="product">
  <div class="product-image-container"><img src="IMG_3843.jpeg" class="product-image" alt="é»‘çŒªä¸‰ä¸çº¸çš®çƒ§å–"></div>
  <div class="product-name">é»‘çŒªä¸‰ä¸çº¸çš®çƒ§å–</div>
  <div class="product-price">RM15</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="é»‘çŒªä¸‰ä¸çº¸çš®çƒ§å–">-</button>
    <input type="number" class="quantity-input" id="é»‘çŒªä¸‰ä¸çº¸çš®çƒ§å–" value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="é»‘çŒªä¸‰ä¸çº¸çš®çƒ§å–">+</button>
  </div>
</div>

<div class="product">
  <div class="product-image-container"><img src="IMG_3842.jpeg" class="product-image" alt="é»‘æ¤’ç‰›è‚‰çº¸çš®çƒ§å–"></div>
  <div class="product-name">é»‘æ¤’ç‰›è‚‰çº¸çš®çƒ§å–</div>
  <div class="product-price">RM15</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="é»‘æ¤’ç‰›è‚‰çº¸çš®çƒ§å–">-</button>
    <input type="number" class="quantity-input" id="é»‘æ¤’ç‰›è‚‰çº¸çš®çƒ§å–" value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="é»‘æ¤’ç‰›è‚‰çº¸çš®çƒ§å–">+</button>
  </div>
</div>

<div class="product">
  <div class="product-image-container"><img src="IMG_3844.jpeg" class="product-image" alt="é»‘çŒªæ¢…èœå¹²çº¸çš®çƒ§å–"></div>
  <div class="product-name">é»‘çŒªæ¢…èœå¹²çº¸çš®çƒ§å–</div>
  <div class="product-price">RM15</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="é»‘çŒªæ¢…èœå¹²çº¸çš®çƒ§å–">-</button>
    <input type="number" class="quantity-input" id="é»‘çŒªæ¢…èœå¹²çº¸çš®çƒ§å–" value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="é»‘çŒªæ¢…èœå¹²çº¸çš®çƒ§å–">+</button>
  </div>
</div>

<div class="product">
  <div class="product-image-container"><img src="IMG_3845.jpeg" class="product-image" alt="ä¸‰ä¸èŠå£«çº¸çš®çƒ§å–"></div>
  <div class="product-name">ä¸‰ä¸èŠå£«çº¸çš®çƒ§å–</div>
  <div class="product-price">RM15</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="ä¸‰ä¸èŠå£«çº¸çš®çƒ§å–">-</button>
    <input type="number" class="quantity-input" id="ä¸‰ä¸èŠå£«çº¸çš®çƒ§å–" value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="ä¸‰ä¸èŠå£«çº¸çš®çƒ§å–">+</button>
  </div>
</div>

<div class="product">
  <div class="product-image-container"><img src="IMG_3846.jpeg" class="product-image" alt="ä¹Œç±³è…Šå‘³çº¸çš®çƒ§å–"></div>
  <div class="product-name">ä¹Œç±³è…Šå‘³çº¸çš®çƒ§å–</div>
  <div class="product-price">RM15</div>
  <div class="quantity-control">
    <button type="button" class="quantity-btn minus" data-product="ä¹Œç±³è…Šå‘³çº¸çš®çƒ§å–">-</button>
    <input type="number" class="quantity-input" id="ä¹Œç±³è…Šå‘³çº¸çš®çƒ§å–" value="0" min="0">
    <button type="button" class="quantity-btn plus" data-product="ä¹Œç±³è…Šå‘³çº¸çš®çƒ§å–">+</button>
  </div>
</div>

    <!-- å…±è®¡ 27 é¡¹å•†å“ï¼Œé€é¡¹ç»“æ„ä¸ä¸Šè¿°ä¸€è‡´ -->

    <!-- ğŸ§¾ æ€»é‡‘é¢ -->
    <div class="total">å…±è®¡ï¼šRM<span id="totalAmount">0.00</span></div>

    <!-- âœï¸ å¤‡æ³¨æ  -->
    <div class="form-group">
      <label for="remarks">å¤‡æ³¨</label>
      <textarea id="remarks" name="remarks" placeholder="å¯å¡«å†™å–è´§å¤‡æ³¨ã€å£å‘³åå¥½ç­‰..."></textarea>
    </div>

    <!-- ğŸ’³ é“¶è¡Œè½¬è´¦ä¿¡æ¯ -->
    <div class="bank-info">
      <strong>é“¶è¡Œåç§°ï¼š</strong>Maybank<br />
      <strong>æˆ·å£åï¼š</strong>Choong Sher Lee<br />
      <strong>æˆ·å£å·ç ï¼š</strong>114209540438<br />
      <div style="margin-top:10px; display:flex; justify-content:space-between; gap:10px;">
        <img src="IMG_4043.jpeg" alt="æ”¶æ¬¾äºŒç»´ç 1" />
        <img src="IMG_4042.png" alt="æ”¶æ¬¾äºŒç»´ç 2" />
      </div>
    </div>

    <!-- ä¸Šä¼ è½¬è´¦å‡­è¯ -->
    <div class="form-group file-upload">
      <label for="payment">è¯·ä¸Šä¼ è½¬è´¦å‡­è¯ *</label>
      <input type="file" id="payment" name="payment" accept="image/*,.pdf" required />
    </div>

    <!-- æäº¤æŒ‰é’® -->
    <button type="submit" class="submit-btn">ğŸš€ æäº¤è®¢å•</button>

    <!-- ç®¡ç†å‘˜å¯¼å‡ºåŠŸèƒ½ -->
    <div class="admin-export">
      <div class="form-group">
        <label for="adminPassword">ç®¡ç†å‘˜å¯†ç </label>
        <input type="password" id="adminPassword" />
      </div>
      <button id="realExportBtn" class="submit-btn">ğŸ“¥ å¯¼å‡º Excel</button>
    </div>
    <button id="showExportBtn" class="submit-btn" style="background:#555;margin-top:10px;">ğŸ‘¨â€ğŸ’¼ ç®¡ç†å‘˜å¯¼å‡º</button>
  </form>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const SUPABASE_URL = 'https://edfnhhthztskuuosuasw.supabase.co';
  const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...KoAo'; // ä¿ç•™åŸæœ‰å®Œæ•´ key
  const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

  function calculateTotal() {
    let total = 0;
    document.querySelectorAll('.quantity-input').forEach(input => {
      const qty = parseInt(input.value) || 0;
      if (qty > 0) {
        const price = parseFloat(input.closest('.product').querySelector('.product-price').textContent.replace('RM', ''));
        total += qty * price;
      }
    });
    document.getElementById('totalAmount').textContent = total.toFixed(2);
    return total;
  }

  // åŠ å‡æŒ‰é’®åŠŸèƒ½
  document.querySelectorAll('.quantity-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const input = document.getElementById(btn.dataset.product);
      let val = parseInt(input.value) || 0;
      val = btn.classList.contains('plus') ? val + 1 : Math.max(0, val - 1);
      input.value = val;
      calculateTotal();
    });
  });

  // æ‰‹åŠ¨è¾“å…¥ç›‘å¬
  document.querySelectorAll('.quantity-input').forEach(input => {
    input.addEventListener('input', () => {
      input.value = Math.max(0, parseInt(input.value) || 0);
      calculateTotal();
    });
  });

  function generateOrderId() {
    const now = new Date();
    return `FWP${now.getFullYear()}${(now.getMonth()+1).toString().padStart(2,'0')}${now.getDate().toString().padStart(2,'0')}${now.getHours()}${now.getMinutes()}${now.getSeconds()}`;
  }

  function buildWhatsAppMessage(order) {
    const phoneFormatted = order.phone.replace(/\D/g, '').replace(/^0/, '60');
    let msg = `*ğŸ›ï¸ [æ–°è®¢å•] é”‹å‘³æ´¾è®¢å• #${order.order_id}*%0A%0A`;
    msg += `ğŸ‘¤ *å®¢æˆ·ä¿¡æ¯*:%0Aâ–«ï¸ å§“å: ${order.name}%0Aâ–«ï¸ ç”µè¯: https://wa.me/${phoneFormatted}%0Aâ–«ï¸ å–è´§æ–¹å¼: ${order.delivery}%0A%0A`;
    msg += `ğŸ›’ *è®¢å•å†…å®¹*:%0A`;
    order.items.forEach(i => {
      msg += `â–«ï¸ ${i.product} Ã— ${i.quantity} = RM${(i.quantity * i.price).toFixed(2)}%0A`;
    });
    msg += `%0AğŸ’° æ€»é‡‘é¢: RM${order.total.toFixed(2)}%0AğŸ“ å¤‡æ³¨: ${order.remarks || 'æ— '}%0AğŸ“… æ—¶é—´: ${new Date().toLocaleString('zh-CN')}`;
    return msg;
  }

  async function submitOrder(order, whatsappMsg) {
    try {
      const file = document.getElementById('payment').files[0];
      let paymentUrl = '';
      if (file) {
        const ext = file.name.split('.').pop();
        const fileName = `proofs/${Date.now()}_${Math.random().toString(36).slice(2)}.${ext}`;
        const { error: uploadError } = await supabase.storage.from('payment-proofs').upload(fileName, file);
        if (uploadError) throw uploadError;
        const { data } = supabase.storage.from('payment-proofs').getPublicUrl(fileName);
        paymentUrl = data.publicUrl;
      }

      await supabase.from('orders').insert([{
        order_id: order.order_id,
        name: order.name,
        phone: order.phone,
        delivery_method: order.delivery,
        order_items: order.items,
        total_amount: order.total,
        remarks: order.remarks,
        payment_proof_url: paymentUrl,
        created_at: new Date().toISOString()
      }]);

      const waLink = `https://wa.me/60162327792?text=${encodeURIComponent(whatsappMsg)}`;
      const link = document.createElement('a');
      link.href = waLink;
      link.target = '_blank';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      alert('âœ… è®¢å•å·²æäº¤å¹¶è·³è½¬ WhatsApp');
    } catch (err) {
      console.error('æäº¤å¤±è´¥', err);
      alert('âŒ æäº¤å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–é‡è¯•');
    }
  }

  function validateForm() {
    const name = document.getElementById('name').value.trim();
    const phone = document.getElementById('phone').value.trim();
    const delivery = document.getElementById('delivery').value;
    const agree = document.getElementById('agreeCheckbox').checked;
    const payment = document.getElementById('payment').files.length > 0;
    const total = calculateTotal();
    if (!name || !phone || !delivery || !agree || !payment) {
      alert('è¯·å®Œæ•´å¡«å†™æ‰€æœ‰å¿…å¡«é¡¹å¹¶å‹¾é€‰åŒæ„å£°æ˜');
      return false;
    }
    if (total === 0) {
      alert('è¯·è‡³å°‘é€‰æ‹©ä¸€é¡¹å•†å“');
      return false;
    }
    return true;
  }

  function collectOrderData() {
    const items = [];
    document.querySelectorAll('.quantity-input').forEach(input => {
      const qty = parseInt(input.value) || 0;
      if (qty > 0) {
        const product = input.id;
        const price = parseFloat(input.closest('.product').querySelector('.product-price').textContent.replace('RM', ''));
        items.push({ product, quantity: qty, price });
      }
    });

    return {
      order_id: generateOrderId(),
      name: document.getElementById('name').value.trim(),
      phone: document.getElementById('phone').value.trim(),
      delivery: document.getElementById('delivery').value,
      remarks: document.getElementById('remarks').value.trim(),
      items,
      total: calculateTotal()
    };
  }

  document.getElementById('orderForm').addEventListener('submit', (e) => {
    e.preventDefault();
    if (!validateForm()) return;
    const order = collectOrderData();
    const msg = buildWhatsAppMessage(order);
    if (confirm('è¯·ç¡®è®¤è®¢å•å†…å®¹æ— è¯¯ï¼Œç‚¹å‡»ç¡®å®šæäº¤è®¢å•å¹¶è·³è½¬ WhatsApp')) {
      submitOrder(order, msg);
    }
  });

  document.getElementById('showExportBtn').onclick = () => {
    document.querySelector('.admin-export').style.display = 'block';
  };

  document.getElementById('realExportBtn').onclick = async () => {
    const pwd = document.getElementById('adminPassword').value;
    if (pwd !== 'fengweipaiadmin') return alert('å¯†ç é”™è¯¯');

    const { data, error } = await supabase.from('orders').select('*');
    if (error) return alert('å¯¼å‡ºå¤±è´¥');
    if (!data || data.length === 0) return alert('æš‚æ— è®¢å•è®°å½•');

    const rows = data.map(row => ({
      è®¢å•ç¼–å·: row.order_id,
      å§“å: row.name,
      ç”µè¯: row.phone,
      å–è´§æ–¹å¼: row.delivery_method,
      å•†å“: row.order_items.map(i => `${i.product}Ã—${i.quantity}`).join(', '),
      æ€»é‡‘é¢: row.total_amount,
      å¤‡æ³¨: row.remarks,
      ä¸‹å•æ—¶é—´: row.created_at
    }));

    const ws = XLSX.utils.json_to_sheet(rows);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, 'è®¢å•');
    XLSX.writeFile(wb, `é”‹å‘³æ´¾è®¢å•_${new Date().toISOString().slice(0,10)}.xlsx`);
  };
});
</script>
</body>
</html>