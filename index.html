<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>é”‹å‘³æ´¾ç¾é£Ÿå›¢è´­</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
  <style>
    :root {
      --primary: #FF4757;
      --secondary: #FF6B81;
      --accent: #FFA502;
      --light: #F1F2F6;
      --dark: #2F3542;
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
      margin: 0;
      padding: 0;
      background: #f9f9f9;
      color: var(--dark);
    }

    .container {
      max-width: 640px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      background: linear-gradient(to right, var(--primary), var(--secondary));
      padding: 20px;
      text-align: center;
      color: white;
      border-radius: 0 0 16px 16px;
    }

    .header h1 {
      margin: 0;
      font-size: 24px;
    }

    h2.category-title {
      font-size: 20px;
      margin: 30px 0 10px;
      padding-left: 10px;
      border-left: 5px solid var(--primary);
    }

    .product {
      background: white;
      border-radius: 10px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }

    .product-image-container {
      width: 100%;
      height: 180px;
      border-radius: 8px;
      overflow: hidden;
      margin-bottom: 10px;
      background: #eee;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .product-image {
      max-height: 100%;
      max-width: 100%;
      object-fit: cover;
    }

    .product-name {
      font-weight: bold;
      margin-bottom: 6px;
      font-size: 16px;
    }

    .product-price {
      color: var(--primary);
      font-weight: bold;
      margin-bottom: 10px;
    }

    .quantity-control {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .quantity-btn {
      width: 32px;
      height: 32px;
      border: none;
      background: var(--primary);
      color: white;
      font-size: 20px;
      border-radius: 50%;
      cursor: pointer;
    }

    .quantity-input {
      width: 60px;
      text-align: center;
      font-size: 16px;
      padding: 6px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }

    .total {
      background: #fff;
      padding: 12px 16px;
      border-radius: 8px;
      font-size: 18px;
      font-weight: bold;
      text-align: right;
      margin-top: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }

    .form-group {
      margin-top: 20px;
    }

    .form-group label {
      display: block;
      font-weight: 600;
      margin-bottom: 6px;
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 15px;
    }

    .form-group textarea {
      height: 48px;
      resize: vertical;
    }

    .submit-btn {
      width: 100%;
      padding: 14px;
      margin-top: 24px;
      background: linear-gradient(to right, var(--primary), var(--secondary));
      color: white;
      font-size: 16px;
      font-weight: bold;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    .file-upload {
      background: #fff;
      padding: 16px;
      border-radius: 8px;
      border: 1px dashed #ccc;
      margin-top: 20px;
    }

    .file-upload input[type="file"] {
      width: 100%;
    }

    .bank-info {
      background: #fff;
      padding: 16px;
      border-radius: 8px;
      margin-top: 20px;
      border: 1px solid #eee;
    }

    .bank-info img {
      width: 48%;
      border-radius: 8px;
      margin-top: 10px;
    }

    .disclaimer-box {
      background-color: #fff3f3;
      border-left: 5px solid var(--primary);
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 20px;
    }

    .disclaimer-checkbox {
      margin-top: 10px;
    }

    .confirmation-dialog {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.6);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .confirmation-box {
      background: white;
      padding: 20px;
      border-radius: 12px;
      max-width: 600px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }

    .confirmation-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }

    .confirmation-btn {
      padding: 10px 16px;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
    }

    .confirmation-cancel {
      background: #ccc;
    }

    .confirmation-submit {
      background: var(--primary);
      color: white;
    }

    .admin-export {
      background: #fff;
      padding: 16px;
      border-radius: 8px;
      margin-top: 30px;
      border: 1px solid #eee;
    }

    .admin-export input {
      margin-top: 10px;
      margin-bottom: 10px;
    }

    .emoji {
      margin-right: 6px;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>ğŸ¢ é”‹å‘³æ´¾ç¾é£Ÿå›¢è´­</h1>
  </div>
  <div class="container">

    <form id="orderForm">
      <!-- é‡è¦å£°æ˜ -->
      <div class="disclaimer-box">
        <h3>âš ï¸ é‡è¦å£°æ˜ / Important Notice</h3>
        <p>1. æ­¤ä¸ºé¢„è´­å•†å“ï¼Œæˆ‘ä»¬å°†æ”¶é›†æ‰€æœ‰è®¢å•åç»Ÿä¸€å‘ä¾›åº”å•†ä¸‹å•ã€‚<br>1. This is a pre-order. We will place the bulk order after collecting all purchases.</p>
        <p>2. é¢„è®¡ç­‰å¾…æ—¶é—´ï¼š30-60å¤©ï¼ˆä»ä¸‹å•æ—¥èµ·è®¡ç®—ï¼‰ã€‚<br>2. Estimated waiting time: 30-60 days (from order date).</p>
        <p>3. å½“å‰ä»·æ ¼<strong>ä¸åŒ…å«</strong>å›½é™…è¿è´¹ï¼Œè¿è´¹å°†æ ¹æ®å®é™…ç‰©æµæˆæœ¬åç»­é€šçŸ¥æ”¶å–ã€‚<br>3. Prices <strong>do not include</strong> international shipping fees. Fees will be calculated later.</p>
        <div class="disclaimer-checkbox">
          <label>
            <input type="checkbox" id="agreeCheckbox" /> æˆ‘å·²é˜…è¯»å¹¶åŒæ„ä¸Šè¿°æ¡æ¬¾
          </label>
        </div>
      </div>

      <!-- é¡¾å®¢ä¿¡æ¯ -->
      <div class="form-group">
        <label for="name"><span class="emoji">ğŸ‘¤</span>å§“å *</label>
        <input type="text" id="name" name="name" required />
      </div>

      <div class="form-group">
        <label for="phone"><span class="emoji">ğŸ“±</span>ç”µè¯ *</label>
        <input type="tel" id="phone" name="phone" required />
      </div>

      <div class="form-group">
        <label for="delivery"><span class="emoji">ğŸšš</span>å–è´§æ–¹å¼ *</label>
        <select id="delivery" name="delivery" required>
          <option value="">è¯·é€‰æ‹©...</option>
          <option value="self-pickup">è‡ªå– Self Pickup</option>
          <option value="lalamove">Lalamove é€è´§</option>
        </select>
      </div>

      <h2 class="category-title"><span class="emoji">ğŸ›’</span>è¯·é€‰æ‹©å•†å“</h2>

      <!-- å•†å“æ¸…å•ï¼šçƒ¤è‚ ç³»åˆ— -->
      <h2 class="category-title"><span class="emoji">ğŸŒ­</span>çƒ¤è‚ ç³»åˆ—</h2>

      <div class="product">
        <div class="product-image-container">
          <img src="IMG_3859.jpeg" class="product-image" alt="åŸå‘³çƒ¤è‚ " />
        </div>
        <div class="product-name">åŸå‘³çƒ¤è‚  <span class="tag">ğŸ”¥ çˆ†æ¬¾</span></div>
        <div class="product-price">RM28</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="åŸå‘³çƒ¤è‚ ">-</button>
          <input type="number" class="quantity-input" id="åŸå‘³çƒ¤è‚ " value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="åŸå‘³çƒ¤è‚ ">+</button>
        </div>
      </div>

      <div class="product">
        <div class="product-image-container">
          <img src="IMG_3864.jpeg" class="product-image" alt="çƒŸç†èœœæ±çƒ¤è‚ " />
        </div>
        <div class="product-name">çƒŸç†èœœæ±çƒ¤è‚ </div>
        <div class="product-price">RM28</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="çƒŸç†èœœæ±çƒ¤è‚ ">-</button>
          <input type="number" class="quantity-input" id="çƒŸç†èœœæ±çƒ¤è‚ " value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="çƒŸç†èœœæ±çƒ¤è‚ ">+</button>
        </div>
      </div>

      <div class="product">
        <div class="product-image-container">
          <img src="IMG_3863.jpeg" class="product-image" alt="æ³•å¼é¦™è‰çƒ¤è‚ " />
        </div>
        <div class="product-name">æ³•å¼é¦™è‰çƒ¤è‚ </div>
        <div class="product-price">RM28</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="æ³•å¼é¦™è‰çƒ¤è‚ ">-</button>
          <input type="number" class="quantity-input" id="æ³•å¼é¦™è‰çƒ¤è‚ " value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="æ³•å¼é¦™è‰çƒ¤è‚ ">+</button>
        </div>
      </div>

      <div class="product">
        <div class="product-image-container">
          <img src="IMG_3860.jpeg" class="product-image" alt="é»‘èƒ¡æ¤’çƒ¤è‚ " />
        </div>
        <div class="product-name">é»‘èƒ¡æ¤’çƒ¤è‚ </div>
        <div class="product-price">RM28</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="é»‘èƒ¡æ¤’çƒ¤è‚ ">-</button>
          <input type="number" class="quantity-input" id="é»‘èƒ¡æ¤’çƒ¤è‚ " value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="é»‘èƒ¡æ¤’çƒ¤è‚ ">+</button>
        </div>
      </div>

      <div class="product">
        <div class="product-image-container">
          <img src="IMG_3862.jpeg" class="product-image" alt="å­œç„¶è„†éª¨çƒ¤è‚ " />
        </div>
        <div class="product-name">å­œç„¶è„†éª¨çƒ¤è‚ </div>
        <div class="product-price">RM28</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="å­œç„¶è„†éª¨çƒ¤è‚ ">-</button>
          <input type="number" class="quantity-input" id="å­œç„¶è„†éª¨çƒ¤è‚ " value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="å­œç„¶è„†éª¨çƒ¤è‚ ">+</button>
        </div>
      </div>

      <div class="product">
        <div class="product-image-container">
          <img src="IMG_3861.jpeg" class="product-image" alt="èŠå£«ç‰ç±³çƒ¤è‚ " />
        </div>
        <div class="product-name">èŠå£«ç‰ç±³çƒ¤è‚ </div>
        <div class="product-price">RM28</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="èŠå£«ç‰ç±³çƒ¤è‚ ">-</button>
          <input type="number" class="quantity-input" id="èŠå£«ç‰ç±³çƒ¤è‚ " value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="èŠå£«ç‰ç±³çƒ¤è‚ ">+</button>
        </div>
      </div>

      <!-- è™¾è‚ ç³»åˆ— -->
      <h2 class="category-title"><span class="emoji">ğŸ¦</span>è™¾è‚ &è™¾é¥¼ç³»åˆ—</h2>
      <div class="product">
        <div class="product-image-container"><img src="IMG_3853.jpeg" class="product-image" alt="åŸå‘³è™¾è‚ " /></div>
        <div class="product-name">åŸå‘³è™¾è‚  <span class="tag">ğŸ†• æ–°å“</span></div>
        <div class="product-price">RM33</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="åŸå‘³è™¾è‚ ">-</button>
          <input type="number" class="quantity-input" id="åŸå‘³è™¾è‚ " value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="åŸå‘³è™¾è‚ ">+</button>
        </div>
      </div>
      <div class="product">
        <div class="product-image-container"><img src="IMG_3854.jpeg" class="product-image" alt="è¾£å‘³è™¾è‚ " /></div>
        <div class="product-name">è¾£å‘³è™¾è‚  <span class="tag">ğŸŒ¶ï¸ çƒ­å–</span></div>
        <div class="product-price">RM33</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="è¾£å‘³è™¾è‚ ">-</button>
          <input type="number" class="quantity-input" id="è¾£å‘³è™¾è‚ " value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="è¾£å‘³è™¾è‚ ">+</button>
        </div>
      </div>
      <div class="product">
        <div class="product-image-container"><img src="IMG_3873.jpeg" class="product-image" alt="è™¾é¥¼" /></div>
        <div class="product-name">è™¾é¥¼</div>
        <div class="product-price">RM28</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="è™¾é¥¼">-</button>
          <input type="number" class="quantity-input" id="è™¾é¥¼" value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="è™¾é¥¼">+</button>
        </div>
      </div>

      <!-- æŠ«è¨ç³»åˆ— -->
      <h2 class="category-title"><span class="emoji">ğŸ•</span>æŠ«è¨ç³»åˆ—</h2>
      <div class="product">
        <div class="product-image-container"><img src="IMG_3841.jpeg" class="product-image" alt="ç›æ ¼ä¸½ç‰¹æŠ«è¨" /></div>
        <div class="product-name">ç›æ ¼ä¸½ç‰¹æŠ«è¨</div>
        <div class="product-price">RM25</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="ç›æ ¼ä¸½ç‰¹æŠ«è¨">-</button>
          <input type="number" class="quantity-input" id="ç›æ ¼ä¸½ç‰¹æŠ«è¨" value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="ç›æ ¼ä¸½ç‰¹æŠ«è¨">+</button>
        </div>
      </div>
      <div class="product">
        <div class="product-image-container"><img src="IMG_3839.jpeg" class="product-image" alt="é»‘æ¤’ç‰›è‚‰æŠ«è¨" /></div>
        <div class="product-name">é»‘æ¤’ç‰›è‚‰æŠ«è¨</div>
        <div class="product-price">RM25</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="é»‘æ¤’ç‰›è‚‰æŠ«è¨">-</button>
          <input type="number" class="quantity-input" id="é»‘æ¤’ç‰›è‚‰æŠ«è¨" value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="é»‘æ¤’ç‰›è‚‰æŠ«è¨">+</button>
        </div>
      </div>
      <div class="product">
        <div class="product-image-container"><img src="IMG_3840.jpeg" class="product-image" alt="å¥¥å°”è‰¯é¸¡è‚‰æŠ«è¨" /></div>
        <div class="product-name">å¥¥å°”è‰¯é¸¡è‚‰æŠ«è¨</div>
        <div class="product-price">RM25</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="å¥¥å°”è‰¯é¸¡è‚‰æŠ«è¨">-</button>
          <input type="number" class="quantity-input" id="å¥¥å°”è‰¯é¸¡è‚‰æŠ«è¨" value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="å¥¥å°”è‰¯é¸¡è‚‰æŠ«è¨">+</button>
        </div>
      </div>
      <div class="product">
        <div class="product-image-container"><img src="IMG_3852.jpeg" class="product-image" alt="åŒæ–™æ¦´è²æŠ«è¨" /></div>
        <div class="product-name">åŒæ–™æ¦´è²æŠ«è¨ <span class="tag">ğŸŒŸ æ‹›ç‰Œ</span></div>
        <div class="product-price">RM40</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="åŒæ–™æ¦´è²æŠ«è¨">-</button>
          <input type="number" class="quantity-input" id="åŒæ–™æ¦´è²æŠ«è¨" value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="åŒæ–™æ¦´è²æŠ«è¨">+</button>
        </div>
      </div>

      <!-- é…¥é¥¼ç³»åˆ— -->
      <h2 class="category-title"><span class="emoji">ğŸ¥®</span>é…¥é¥¼ç³»åˆ—</h2>
      <div class="product">
        <div class="product-image-container"><img src="IMG_3837.jpeg" class="product-image" alt="é»‘çŒªè‚‰é…¥é¥¼" /></div>
        <div class="product-name">é»‘çŒªè‚‰é…¥é¥¼</div>
        <div class="product-price">RM55</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="é»‘çŒªè‚‰é…¥é¥¼">-</button>
          <input type="number" class="quantity-input" id="é»‘çŒªè‚‰é…¥é¥¼" value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="é»‘çŒªè‚‰é…¥é¥¼">+</button>
        </div>
      </div>
      <div class="product">
        <div class="product-image-container"><img src="IMG_3838.jpeg" class="product-image" alt="å®‰æ ¼æ–¯ç‰›è‚‰é…¥é¥¼" /></div>
        <div class="product-name">å®‰æ ¼æ–¯ç‰›è‚‰é…¥é¥¼</div>
        <div class="product-price">RM55</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="å®‰æ ¼æ–¯ç‰›è‚‰é…¥é¥¼">-</button>
          <input type="number" class="quantity-input" id="å®‰æ ¼æ–¯ç‰›è‚‰é…¥é¥¼" value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="å®‰æ ¼æ–¯ç‰›è‚‰é…¥é¥¼">+</button>
        </div>
      </div>

      <!-- å°ç¬¼æ±¤åŒ…ç³»åˆ— -->
      <h2 class="category-title"><span class="emoji">ğŸ¥Ÿ</span>å°ç¬¼æ±¤åŒ…ç³»åˆ—</h2>
      <div class="product">
        <div class="product-image-container"><img src="IMG_3874.jpeg" class="product-image" alt="é²œè‚‰å°ç¬¼æ±¤åŒ…" /></div>
        <div class="product-name">é²œè‚‰å°ç¬¼æ±¤åŒ…</div>
        <div class="product-price">RM12</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="é²œè‚‰å°ç¬¼æ±¤åŒ…">-</button>
          <input type="number" class="quantity-input" id="é²œè‚‰å°ç¬¼æ±¤åŒ…" value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="é²œè‚‰å°ç¬¼æ±¤åŒ…">+</button>
        </div>
      </div>
      <div class="product">
        <div class="product-image-container"><img src="IMG_3875.jpeg" class="product-image" alt="èŒè‡å°ç¬¼æ±¤åŒ…" /></div>
        <div class="product-name">èŒè‡å°ç¬¼æ±¤åŒ…</div>
        <div class="product-price">RM12</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="èŒè‡å°ç¬¼æ±¤åŒ…">-</button>
          <input type="number" class="quantity-input" id="èŒè‡å°ç¬¼æ±¤åŒ…" value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="èŒè‡å°ç¬¼æ±¤åŒ…">+</button>
        </div>
      </div>
      <div class="product">
        <div class="product-image-container"><img src="IMG_3876.jpeg" class="product-image" alt="é»‘æ¾éœ²å°ç¬¼æ±¤åŒ…" /></div>
        <div class="product-name">é»‘æ¾éœ²å°ç¬¼æ±¤åŒ… <span class="tag">ğŸ’ è±ªå</span></div>
        <div class="product-price">RM12</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="é»‘æ¾éœ²å°ç¬¼æ±¤åŒ…">-</button>
          <input type="number" class="quantity-input" id="é»‘æ¾éœ²å°ç¬¼æ±¤åŒ…" value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="é»‘æ¾éœ²å°ç¬¼æ±¤åŒ…">+</button>
        </div>
      </div>

      <!-- é¸¡æ’ç³»åˆ— -->
      <h2 class="category-title"><span class="emoji">ğŸ—</span>é¸¡æ’ç³»åˆ—</h2>
      <div class="product">
        <div class="product-image-container"><img src="IMG_3835.jpeg" class="product-image" alt="åŸå‘³é¸¡æ’" /></div>
        <div class="product-name">åŸå‘³é¸¡æ’ <span class="tag">ğŸ† æ— æŠ—è®¤è¯</span></div>
        <div class="product-price">RM20</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="åŸå‘³é¸¡æ’">-</button>
          <input type="number" class="quantity-input" id="åŸå‘³é¸¡æ’" value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="åŸå‘³é¸¡æ’">+</button>
        </div>
      </div>
      <div class="product">
        <div class="product-image-container"><img src="IMG_3836.jpeg" class="product-image" alt="å¥¥å°”è‰¯é¸¡æ’" /></div>
        <div class="product-name">å¥¥å°”è‰¯é¸¡æ’</div>
        <div class="product-price">RM20</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="å¥¥å°”è‰¯é¸¡æ’">-</button>
          <input type="number" class="quantity-input" id="å¥¥å°”è‰¯é¸¡æ’" value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="å¥¥å°”è‰¯é¸¡æ’">+</button>
        </div>
      </div>

      <!-- é¸¡ç¿…ç³»åˆ— -->
      <h2 class="category-title"><span class="emoji">ğŸ—</span>é¸¡ç¿…ç³»åˆ—</h2>
      <div class="product">
        <div class="product-image-container"><img src="IMG_3865.jpeg" class="product-image" alt="å¥¥å°”è‰¯é¸¡ç¿…" /></div>
        <div class="product-name">å¥¥å°”è‰¯é¸¡ç¿…</div>
        <div class="product-price">RM25</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="å¥¥å°”è‰¯é¸¡ç¿…">-</button>
          <input type="number" class="quantity-input" id="å¥¥å°”è‰¯é¸¡ç¿…" value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="å¥¥å°”è‰¯é¸¡ç¿…">+</button>
        </div>
      </div>
      <div class="product">
        <div class="product-image-container"><img src="IMG_3866.jpeg" class="product-image" alt="é’èŠ±æ¤’é¸¡ç¿…" /></div>
        <div class="product-name">é’èŠ±æ¤’é¸¡ç¿… <span class="tag">ğŸŒ¶ï¸ éº»è¾£</span></div>
        <div class="product-price">RM25</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="é’èŠ±æ¤’é¸¡ç¿…">-</button>
          <input type="number" class="quantity-input" id="é’èŠ±æ¤’é¸¡ç¿…" value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="é’èŠ±æ¤’é¸¡ç¿…">+</button>
        </div>
      </div>

      <!-- çº¸çš®çƒ§å–ç³»åˆ— -->
      <h2 class="category-title"><span class="emoji">ğŸ¥Ÿ</span>çº¸çš®çƒ§å–ç³»åˆ—</h2>
      <div class="product">
        <div class="product-image-container"><img src="IMG_3843.jpeg" class="product-image" alt="é»‘çŒªä¸‰ä¸çº¸çš®çƒ§å–" /></div>
        <div class="product-name">é»‘çŒªä¸‰ä¸çº¸çš®çƒ§å–</div>
        <div class="product-price">RM15</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="é»‘çŒªä¸‰ä¸çº¸çš®çƒ§å–">-</button>
          <input type="number" class="quantity-input" id="é»‘çŒªä¸‰ä¸çº¸çš®çƒ§å–" value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="é»‘çŒªä¸‰ä¸çº¸çš®çƒ§å–">+</button>
        </div>
      </div>
      <div class="product">
        <div class="product-image-container"><img src="IMG_3842.jpeg" class="product-image" alt="é»‘æ¤’ç‰›è‚‰çº¸çš®çƒ§å–" /></div>
        <div class="product-name">é»‘æ¤’ç‰›è‚‰çº¸çš®çƒ§å–</div>
        <div class="product-price">RM15</div>
        <div class="quantity-control">
          <button type="button" class="quantity-btn minus" data-product="é»‘æ¤’ç‰›è‚‰çº¸çš®çƒ§å–">-</button>
          <input type="number" class="quantity-input" id="é»‘æ¤’ç‰›è‚‰çº¸çš®çƒ§å–" value="0" min="0" />
          <button type="button" class="quantity-btn plus" data-product="é»‘æ¤’ç‰›è‚‰çº¸çš®çƒ§å–">+</button>
        </div>
      </div>

      <!-- æ€»é‡‘é¢ -->
      <div class="total">å…±è®¡ï¼šRM<span id="totalAmount">0</span></div>

      <!-- å¤‡æ³¨æ  -->
      <div class="form-group">
        <label for="remarks"><span class="emoji">ğŸ“</span>å¤‡æ³¨ (å¯é€‰)</label>
        <textarea id="remarks" name="remarks" placeholder="å¡«å†™æ‚¨å¸Œæœ›å¤‡æ³¨çš„å†…å®¹ï¼Œä¾‹å¦‚ï¼šä¸è¦è¾£ã€ä¸å«èŠ±ç”Ÿç­‰"></textarea>
      </div>

      <!-- é“¶è¡Œè½¬è´¦ä¿¡æ¯ -->
      <div class="bank-info">
        <strong>é“¶è¡Œåç§°ï¼š</strong>Maybank<br />
        <strong>æˆ·å£åç§°ï¼š</strong>Choong Sher Lee<br />
        <strong>æˆ·å£å·ç ï¼š</strong>114209540438
        <div style="display:flex; gap:4%; justify-content:space-between;">
          <img src="IMG_4043.jpeg" alt="QR Code 1" />
          <img src="IMG_4042.png" alt="QR Code 2" />
        </div>
      </div>

      <!-- ä¸Šä¼ è½¬è´¦å‡­è¯ -->
      <div class="form-group file-upload">
        <label for="payment"><span class="emoji">ğŸ’³</span>è¯·ä¸Šä¼ è½¬è´¦å‡­è¯ *</label>
        <input type="file" id="payment" name="payment" accept="image/*,.pdf" required />
      </div>

      <!-- æäº¤æŒ‰é’® -->
      <button type="submit" class="submit-btn"><span class="emoji">ğŸš€</span> æäº¤è®¢å•</button>
    </form>

    <!-- ç®¡ç†å‘˜å¯¼å‡ºåŒºåŸŸ -->
    <div class="admin-export">
      <h3 style="margin-top:0">ç®¡ç†å‘˜å¯¼å‡º</h3>
      <input type="password" id="adminPassword" placeholder="è¯·è¾“å…¥å¯¼å‡ºå¯†ç " />
      <button id="realExportBtn" class="submit-btn" style="margin-top:8px;">ğŸ“¤ å¯¼å‡º Excel</button>
    </div>

    <button id="showExportBtn" class="submit-btn" style="background: #6c757d; margin-top: 16px;">ğŸ” ç®¡ç†å‘˜å¯¼å‡ºè®¢å•</button>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const SUPABASE_URL = 'https://edfnhhthztskuuosuasw.supabase.co';
  const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVkZm5oaHRoenRza3V1b3N1YXN3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk5OTYxMTYsImV4cCI6MjA2NTU3MjExNn0.O3g2gjvsWagmWgmzoeJA8mPampvLYJr-KgqVwXsKoAo';
  const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

  function calculateTotal() {
    let total = 0;
    document.querySelectorAll('.quantity-input').forEach(input => {
      const qty = parseInt(input.value) || 0;
      if (qty > 0) {
        const price = parseFloat(input.closest('.product').querySelector('.product-price').textContent.replace('RM', ''));
        total += qty * price;
      }
    });
    document.getElementById('totalAmount').textContent = total.toFixed(2);
    return total;
  }

  // åŠ å‡æŒ‰é’®åŠŸèƒ½
  document.querySelectorAll('.quantity-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const input = document.getElementById(btn.dataset.product);
      let val = parseInt(input.value) || 0;
      val = btn.classList.contains('plus') ? val + 1 : Math.max(0, val - 1);
      input.value = val;
      calculateTotal();
    });
  });

  // æ‰‹åŠ¨è¾“å…¥æ•°é‡ç›‘å¬
  document.querySelectorAll('.quantity-input').forEach(input => {
    input.addEventListener('input', () => {
      input.value = Math.max(0, parseInt(input.value) || 0);
      calculateTotal();
    });
  });

  // æ„é€  WhatsApp æ¶ˆæ¯å†…å®¹
  function buildWhatsAppMessage(order) {
    const phoneFormatted = order.phone.replace(/\D/g, '').replace(/^0/, '60');
    let msg = `*ğŸ›ï¸ [æ–°è®¢å•] é”‹å‘³æ´¾è®¢å• #${order.order_id}*%0A%0A`;
    msg += `ğŸ‘¤ *å®¢æˆ·ä¿¡æ¯*:%0A`;
    msg += `â–«ï¸ å§“å: ${order.name}%0A`;
    msg += `â–«ï¸ ç”µè¯: https://wa.me/${phoneFormatted}%0A`;
    msg += `â–«ï¸ å–è´§æ–¹å¼: ${order.delivery}%0A%0A`;
    msg += `ğŸ›’ *è®¢å•å†…å®¹*:%0A`;
    order.items.forEach(item => {
      msg += `â–«ï¸ ${item.product} Ã— ${item.quantity} = RM${(item.quantity * item.price).toFixed(2)}%0A`;
    });
    msg += `%0AğŸ’° *æ€»é‡‘é¢: RM${order.total.toFixed(2)}*%0A`;
    msg += `ğŸ“ *å¤‡æ³¨*: ${order.remarks || 'ï¼ˆæ— ï¼‰'}%0A`;
    msg += `ğŸ“… ä¸‹å•æ—¶é—´: ${new Date().toLocaleString('zh-CN')}`;
    return msg;
  }

  // æäº¤è®¢å•
  async function submitOrder(orderData, whatsappMessage) {
    try {
      const fileInput = document.getElementById('payment');
      const file = fileInput.files[0];
      let paymentProofUrl = '';
      if (file) {
        const ext = file.name.split('.').pop();
        const fileName = `proofs/${Date.now()}_${Math.random().toString(36).substring(2)}.${ext}`;
        const { error: uploadError } = await supabase.storage.from('payment-proofs').upload(fileName, file);
        if (uploadError) throw uploadError;
        const { data } = supabase.storage.from('payment-proofs').getPublicUrl(fileName);
        paymentProofUrl = data.publicUrl;
      }

      await supabase.from('orders').insert([{
        order_id: orderData.order_id,
        name: orderData.name,
        phone: orderData.phone,
        delivery_method: orderData.delivery,
        order_items: orderData.items,
        total_amount: orderData.total,
        remarks: orderData.remarks,
        payment_proof_url: paymentProofUrl,
        created_at: new Date().toISOString()
      }]);

      // è·³è½¬ WhatsApp
      const url = `https://wa.me/60162327792?text=${encodeURIComponent(whatsappMessage)}`;
      const link = document.createElement('a');
      link.href = url;
      link.target = '_blank';
      link.rel = 'noopener noreferrer';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      alert('è®¢å•å·²æäº¤å¹¶å‘é€è‡³ WhatsApp');
    } catch (err) {
      console.error('æäº¤å¤±è´¥ï¼š', err);
      alert('æäº¤å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–ç¨åå†è¯•');
    }
  }

  // è¡¨å•éªŒè¯
  function validateForm() {
    const name = document.getElementById('name').value.trim();
    const phone = document.getElementById('phone').value.trim();
    const delivery = document.getElementById('delivery').value;
    const agree = document.getElementById('agreeCheckbox').checked;
    const payment = document.getElementById('payment').files.length > 0;
    const total = calculateTotal();
    if (!name || !phone || !delivery || !agree || !payment) {
      alert('è¯·å¡«å†™æ‰€æœ‰å¿…å¡«é¡¹å¹¶åŒæ„å£°æ˜');
      return false;
    }
    if (total === 0) {
      alert('è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªå•†å“');
      return false;
    }
    return true;
  }

  // æ„é€ è®¢å•æ•°æ® + å¼¹å‡ºç¡®è®¤
  function showOrderConfirmation() {
    const items = [];
    document.querySelectorAll('.quantity-input').forEach(input => {
      const qty = parseInt(input.value) || 0;
      if (qty > 0) {
        const productDiv = input.closest('.product');
        const name = input.id;
        const price = parseFloat(productDiv.querySelector('.product-price').textContent.replace('RM', ''));
        items.push({ product: name, quantity: qty, price });
      }
    });

    const orderId = `FWP${Date.now()}`;
    const orderData = {
      order_id: orderId,
      name: document.getElementById('name').value.trim(),
      phone: document.getElementById('phone').value.trim(),
      delivery: document.getElementById('delivery').value,
      remarks: document.getElementById('remarks').value.trim(),
      items,
      total: calculateTotal()
    };
    const message = buildWhatsAppMessage(orderData);

    let preview = `ğŸ§¾ *è®¢å•é¢„è§ˆ*\nå§“åï¼š${orderData.name}\nç”µè¯ï¼š${orderData.phone}\næ–¹å¼ï¼š${orderData.delivery}\n`;
    orderData.items.forEach(i => preview += `${i.product} Ã— ${i.quantity} = RM${(i.price * i.quantity).toFixed(2)}\n`);
    preview += `æ€»é‡‘é¢ï¼šRM${orderData.total.toFixed(2)}\nå¤‡æ³¨ï¼š${orderData.remarks || 'æ— '}`;

    if (confirm(`${preview}\n\nç¡®è®¤æ— è¯¯åå°†æäº¤å¹¶å‘é€ WhatsApp æ¶ˆæ¯`)) {
      submitOrder(orderData, message);
    }
  }

  // è¡¨å•æäº¤ç›‘å¬
  document.getElementById('orderForm').addEventListener('submit', e => {
    e.preventDefault();
    if (validateForm()) {
      showOrderConfirmation();
    }
  });

  // ç®¡ç†å‘˜å¯¼å‡º
  document.getElementById('showExportBtn').onclick = () => {
    document.querySelector('.admin-export').style.display = 'block';
  };
  document.getElementById('realExportBtn').onclick = async () => {
    const pass = document.getElementById('adminPassword').value;
    if (pass !== 'fengweipaiadmin') {
      alert('å¯†ç é”™è¯¯');
      return;
    }
    const { data, error } = await supabase.from('orders').select('*');
    if (error) return alert('å¯¼å‡ºå¤±è´¥');

    const rows = data.map(row => ({
      order_id: row.order_id,
      name: row.name,
      phone: row.phone,
      delivery_method: row.delivery_method,
      items: row.order_items.map(i => `${i.product}Ã—${i.quantity}`).join(', '),
      total_amount: row.total_amount,
      remarks: row.remarks,
      created_at: row.created_at
    }));
    const worksheet = XLSX.utils.json_to_sheet(rows);
    const workbook = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(workbook, worksheet, 'Orders');
    XLSX.writeFile(workbook, `é”‹å‘³æ´¾è®¢å•_${new Date().toISOString().slice(0,10)}.xlsx`);
  };
});
</script>
