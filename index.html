<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é”‹å‘³æ´¾ç¾é£Ÿå›¢è´­</title>
    <!-- æ·»åŠ Excelå¯¼å‡ºåº“ -->
    <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #FF4757;
            --secondary: #FF6B81;
            --accent: #FFA502;
            --light: #F1F2F6;
            --dark: #2F3542;
        }
        body {
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 0;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--dark);
        }
        /* ä¿æŒåŸæœ‰æ‰€æœ‰æ ·å¼ä¸å˜... */
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ¢ é”‹å‘³æ´¾ç¾é£Ÿå›¢è´­</h1>
    </div>

    <div class="container">
        <!-- ä¿®æ”¹åçš„è¡¨å• -->
        <form 
            id="orderForm"
            action="https://formsubmit.co/el/vuzuni" 
            method="POST"
            enctype="multipart/form-data"
        >
            <!-- å¿…é¡»çš„éšè—å­—æ®µ -->
            <input type="hidden" name="_subject" value="é”‹å‘³æ´¾æ–°è®¢å•">
            <input type="hidden" name="_template" value="table">
            <input type="hidden" name="_captcha" value="false">
            <input type="text" name="_honey" style="display:none">

            <!-- å®¢æˆ·ä¿¡æ¯éƒ¨åˆ† -->
            <div class="form-group">
                <label for="name"><span class="emoji">ğŸ‘¤</span>*1. å§“å Name</label>
                <input type="text" id="name" name="customer_name" required placeholder="è¯·è¾“å…¥æ‚¨çš„å§“å">
            </div>

            <div class="form-group">
                <label for="phone"><span class="emoji">ğŸ“±</span>*2. ç”µè¯ HP</label>
                <input type="tel" id="phone" name="customer_phone" required placeholder="è¯·è¾“å…¥è”ç³»ç”µè¯">
            </div>

            <div class="form-group">
                <label for="delivery"><span class="emoji">ğŸšš</span>*3. å–è´§æ–¹å¼ Delivery Method</label>
                <select id="delivery" name="delivery_method" required>
                    <option value="">è¯·é€‰æ‹©å–è´§æ–¹å¼...</option>
                    <option value="self-pickup">è‡ªå– Self pick up</option>
                    <option value="lalamove">Lalamove é€è´§</option>
                </select>
            </div>

            <!-- å•†å“é€‰æ‹©éƒ¨åˆ†ï¼ˆä¿æŒåŸæœ‰ç»“æ„ä¸å˜ï¼‰ -->
            <h2 class="category-title"><span class="emoji">ğŸ›’</span>4. è¯·é€‰æ‹©å•†å“</h2>
            
            <!-- æ‰€æœ‰å•†å“åˆ—è¡¨ä¿æŒä¸å˜... -->
            <!-- ç¤ºä¾‹ï¼šåŸå‘³çƒ¤è‚  -->
            <div class="product">
                <div class="product-image-container">
                    <img src="IMG_3859.jpeg" class="product-image" alt="åŸå‘³çƒ¤è‚ ">
                </div>
                <div class="product-name">åŸå‘³çƒ¤è‚  <span class="tag">ğŸ”¥ çˆ†æ¬¾</span></div>
                <div class="product-price">RM28</div>
                <div class="quantity-control">
                    <button type="button" class="quantity-btn minus" data-product="åŸå‘³çƒ¤è‚ ">-</button>
                    <input type="number" class="quantity-input" name="product_åŸå‘³çƒ¤è‚ " value="0" min="0">
                    <button type="button" class="quantity-btn plus" data-product="åŸå‘³çƒ¤è‚ ">+</button>
                </div>
            </div>

            <!-- å…¶ä»–å•†å“... -->

            <div class="total">
                å…±è®¡ï¼šRM<span id="totalAmount">0</span>
            </div>

            <!-- æ–‡ä»¶ä¸Šä¼  -->
            <div class="file-upload">
                <label for="payment"><span class="emoji">ğŸ’³</span>*5. è¯·ä¸Šä¼ è½¬è´¦å‡­è¯ï¼š</label>
                <input type="file" id="payment" name="payment_proof" accept="image/*,.pdf" required>
            </div>

            <button type="submit" class="submit-btn">
                <span class="emoji">ğŸš€</span> æäº¤è®¢å•
            </button>
        </form>

        <!-- ç®¡ç†å‘˜å¯¼å‡ºé¢æ¿ï¼ˆä¿æŒä¸å˜ï¼‰ -->
        <div class="admin-panel" id="adminPanel">
            <h3 style="margin-top:0; text-align:center">ç®¡ç†å‘˜å¯¼å‡º</h3>
            <input type="password" id="adminPassword" class="password-input" placeholder="è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç ">
            <button id="realExportBtn" class="export-btn">
                <span class="emoji">ğŸ”’</span> ç¡®è®¤å¯¼å‡ºExcel
            </button>
        </div>
        <button id="showExportBtn" class="export-btn">
            <span class="emoji">ğŸ“¤</span> å¯¼å‡ºè®¢å•(éœ€ç®¡ç†å‘˜æƒé™)
        </button>
    </div>

    <script>
        // å•†å“ä»·æ ¼æ˜ å°„
        const productPrices = {
            "åŸå‘³çƒ¤è‚ ": 28,
            "çƒŸç†èœœæ±çƒ¤è‚ ": 28,
            // ä¿æŒåŸæœ‰æ‰€æœ‰å•†å“ä»·æ ¼...
        };

        // æ›´æ–°æ€»é‡‘é¢
        function updateTotal() {
            let total = 0;
            document.querySelectorAll('.quantity-input').forEach(input => {
                const productName = input.getAttribute('name').replace('product_','');
                const price = productPrices[productName] || 0;
                const quantity = parseInt(input.value) || 0;
                total += price * quantity;
            });
            document.getElementById('totalAmount').textContent = total;
        }

        // æ•°é‡åŠ å‡æŒ‰é’®äº‹ä»¶
        document.querySelectorAll('.quantity-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const product = this.dataset.product;
                const input = document.querySelector(`input[name="product_${product}"]`);
                let value = parseInt(input.value) || 0;
                
                if (this.classList.contains('minus')) {
                    value = Math.max(0, value - 1);
                } else {
                    value = value + 1;
                }
                
                input.value = value;
                updateTotal();
            });
        });

        // æ•°é‡è¾“å…¥æ¡†äº‹ä»¶
        document.querySelectorAll('.quantity-input').forEach(input => {
            input.addEventListener('change', updateTotal);
        });

        // è¡¨å•æäº¤ï¼ˆç®€åŒ–ç‰ˆï¼‰
        document.getElementById('orderForm').addEventListener('submit', function(e) {
            // æ£€æŸ¥æ˜¯å¦é€‰æ‹©äº†å•†å“
            let hasItems = false;
            document.querySelectorAll('.quantity-input').forEach(input => {
                if (parseInt(input.value) > 0) hasItems = true;
            });
            
            if (!hasItems) {
                alert('è¯·è‡³å°‘é€‰æ‹©ä¸€ä»¶å•†å“');
                e.preventDefault();
            }
            
            // è‡ªåŠ¨è®¡ç®—æ€»é‡‘é¢å¹¶æ·»åŠ åˆ°è¡¨å•
            const totalInput = document.createElement('input');
            totalInput.type = 'hidden';
            totalInput.name = 'total_amount';
            totalInput.value = document.getElementById('totalAmount').textContent;
            this.appendChild(totalInput);
        });

        // ç®¡ç†å‘˜å¯¼å‡ºåŠŸèƒ½ï¼ˆä¿æŒä¸å˜ï¼‰
        const ADMIN_PASSWORD = "fengwei123";
        document.getElementById('showExportBtn').addEventListener('click', function() {
            document.getElementById('adminPanel').style.display = 'block';
            this.style.display = 'none';
        });
        
        document.getElementById('realExportBtn').addEventListener('click', function() {
            if(document.getElementById('adminPassword').value !== ADMIN_PASSWORD) {
                alert("å¯†ç é”™è¯¯ï¼");
                return;
            }
            
            // æ”¶é›†æ•°æ®ç”ŸæˆExcelï¼ˆåŸæœ‰ä»£ç ï¼‰
            // ...
        });
    </script>
</body>
</html>